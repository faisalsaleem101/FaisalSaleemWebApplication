@model IEnumerable<FaisalLearningProjectMVC.Models.Customer>

@{
    ViewData["Title"] = "Customers";
}

<div>
    <div class="row">
        <div class="col-md-10 col-md-offset-1">
            <!-- ABOUT US SECTION TITLE-->
            <div class="section_title">
                <h2>Customers</h2>
            </div>
        </div>
    </div>
</div>

<p></p>

<div class="text-right table-header">
    <a asp-action="Create"><img src="~/images/add.png" class="index-buttons-topright-row" title="Add Customer" /></a>
    <a asp-action="DownloadExcelTable" id="download-excel"><img src="~/images/ExcelImage.png" title="Download Excel" /> </a>
    <a asp-action="DownloadWordTable" id="download-word"><img src="~/images/WordDocumentImage.png" title="Download Word" /> </a>
    <a asp-action="DownloadPowerpointTable" id="download-powerpoint"><img src="~/images/PowerPointImage.png" title="Download Powerpoint" /> </a>
</div>



<div id="example-table"></div>

@section scripts
    {
    <script>
        $(document).ready(function () {
            $.get("Customers/GetCustomersData", function (data, status) {

                //custom icon formatter
                var DeleteIcon = function (cell, formatterParams) { //plain text value
                    return "<i class='fa fa-trash'></i>";
                };

                var EditIcon = function (cell, formatterParams) { //plain text value
                    return "<i class='fa fa-edit'></i>";
                };

                var ShowIcon = function (cell, formatterParams) { //plain text value
                    return "<i class='fa fa-search'></i>";
                };


                $("#example-table").tabulator({
                    data: data,
                    pagination: "local",
                    paginationSize: 14,
                    layout: "fitColumns",
                    columns: [
                        {
                            title: "", field: "icon", align: "center", width: 30, headerSort: false, formatter: ShowIcon, cellClick:
                                function (e, cell) {
                                    var rowData = cell.getRow().getData();
                                    window.location.href = '@Url.Action("Details", "Customers")/' + rowData.id;
                                }
                        },
                        {
                            title: "", field: "icon", align: "center", width: 30, headerSort: false, formatter: EditIcon, cellClick:
                                function (e, cell) {
                                    var rowData = cell.getRow().getData();
                                    window.location.href = '@Url.Action("Edit", "Customers")/' + rowData.id;
                            }
                        },
                        {
                            title: "", field: "icon", align: "center", width: 30, headerSort: false, formatter: DeleteIcon, cellClick:
                                function (e, cell) {
                                    cell.getRow().delete();

                                    var rowData = cell.getRow().getData();
                                    $.ajax({
                                        url: '/Customers/SoftDelete/' +  rowData.id,
                                        type: 'POST',
                                        contentType: 'application/json; charset=utf-8',
                                        dataType: 'json',

                                    });
                                }
                        },
                        { title: "ID", field: "id", width: 50, visible: false },
                        { title: "Full Name", field: "contactName", sorter: "string", width: 200 },
                        { title: "Company", field: "companyName", sorter: "string", width: 200 },
                        { title: "Job Title", field: "contactTitle", sorter: "string", width: 200 },
                        { title: "Address", field: "address", sorter: "string", width: 200 },
                        { title: "City", field: "city", sorter: "string", width: 100 },
                        { title: "", field: "", width: 118,  headerSort:false },
                        //{ title: "Country", field: "country", sorter: "string", width: 100 },
                    ],
                })

                //Set initial page to start at the first page
                $("#example-table").tabulator("setPage", 1);

            });
        });

    </script>
}
